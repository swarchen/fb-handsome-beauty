!function(){"use strict";angular.module("nvd3",[]).directive("nvd3",["nvd3Utils",function(t){return{restrict:"AE",scope:{data:"=",options:"=",api:"=?",events:"=?",config:"=?",onReady:"&?"},link:function(e,a,n){function i(t,a,n){t&&a&&angular.forEach(t,function(c,r){"_"===r[0]||("dispatch"===r?(void 0!==a[r]&&null!==a[r]||e._config.extended&&(a[r]={}),o(c,a[r])):"tooltip"===r?(void 0!==a[r]&&null!==a[r]||e._config.extended&&(a[r]={}),i(t[r],a[r],n)):"contentGenerator"===r?a[r]&&t[r](a[r]):-1===["axis","clearHighlights","defined","highlightPoint","nvPointerEventsClass","options","rangeBand","rangeBands","scatter","open","close","node"].indexOf(r)&&(void 0===a[r]||null===a[r]?e._config.extended&&(a[r]=c()):t[r](a[r])))})}function o(t,a){t&&a&&angular.forEach(t,function(n,i){void 0===a[i]||null===a[i]?e._config.extended&&(a[i]=n.on):t.on(i+"._",a[i])})}function c(n){var i=t.deepExtend(s(n),e.options[n]||{});e._config.extended&&(e.options[n]=i);var o=angular.element("<div></div>").html(i.html||"").addClass(n).addClass(i.className).removeAttr("style").css(i.css);i.html||o.text(i.text),i.enable&&("title"===n?a.prepend(o):"subtitle"===n?angular.element(a[0].querySelector(".title")).after(o):"caption"===n&&a.append(o))}function r(){var n=t.deepExtend(d(),e.options.styles||{});e._config.extended&&(e.options.styles=n),angular.forEach(n.classes,function(t,e){t?a.addClass(e):a.removeClass(e)}),a.removeAttr("style").css(n.css)}function s(t){switch(t){case"title":return{enable:!1,text:"Write Your Title",className:"h4",css:{width:e.options.chart.width+"px",textAlign:"center"}};case"subtitle":return{enable:!1,text:"Write Your Subtitle",css:{width:e.options.chart.width+"px",textAlign:"center"}};case"caption":return{enable:!1,text:"Figure 1. Write Your Caption text.",css:{width:e.options.chart.width+"px",textAlign:"center"}}}}function d(){return{classes:{"with-3d-shadow":!0,"with-transitions":!0,gallery:!1},css:{}}}function l(t,a){t!==a&&(e._config.disabled||(e._config.refreshDataOnly?e.api.update():e.api.refresh()))}var h={extended:!1,visible:!0,disabled:!1,refreshDataOnly:!0,deepWatchOptions:!0,deepWatchData:!0,deepWatchDataDepth:2,debounce:10,debounceImmediate:!0};e.isReady=!1,e._config=angular.extend(h,e.config),e.api={refresh:function(){e.api.updateWithOptions(e.options),e.isReady=!0},refreshWithTimeout:function(t){setTimeout(function(){e.api.refresh()},t)},update:function(){e.chart&&e.svg?e.svg.datum(e.data).call(e.chart):e.api.refresh()},updateWithTimeout:function(t){setTimeout(function(){e.api.update()},t)},updateWithOptions:function(a){e.api.clearElement(),angular.isDefined(a)!==!1&&e._config.visible&&(e.chart=nv.models[a.chart.type](),e.chart.id=Math.random().toString(36).substr(2,15),angular.forEach(e.chart,function(t,n){"_"===n[0]||["clearHighlights","highlightPoint","id","options","resizeHandler","state","open","close","tooltipContent"].indexOf(n)>=0||("dispatch"===n?(void 0!==a.chart[n]&&null!==a.chart[n]||e._config.extended&&(a.chart[n]={}),o(e.chart[n],a.chart[n])):["bars","bars1","bars2","boxplot","bullet","controls","discretebar","distX","distY","interactiveLayer","legend","lines","lines1","lines2","multibar","pie","scatter","scatters1","scatters2","sparkline","stack1","stack2","sunburst","tooltip","x2Axis","xAxis","y1Axis","y2Axis","y3Axis","y4Axis","yAxis","yAxis1","yAxis2"].indexOf(n)>=0||"stacked"===n&&"stackedAreaChart"===a.chart.type?(void 0!==a.chart[n]&&null!==a.chart[n]||e._config.extended&&(a.chart[n]={}),i(e.chart[n],a.chart[n],a.chart.type)):"focusHeight"===n&&"lineChart"===a.chart.type||"focusHeight"===n&&"lineWithFocusChart"===a.chart.type||("xTickFormat"!==n&&"yTickFormat"!==n||"lineWithFocusChart"!==a.chart.type)&&("tooltips"===n&&"boxPlotChart"===a.chart.type||("tooltipXContent"!==n&&"tooltipYContent"!==n||"scatterChart"!==a.chart.type)&&("x"!==n&&"y"!==n||"forceDirectedGraph"!==a.chart.type)&&(void 0===a.chart[n]||null===a.chart[n]?e._config.extended&&("barColor"===n?a.chart[n]=t()():a.chart[n]=t()):e.chart[n](a.chart[n]))))}),"sunburstChart"===a.chart.type?e.api.updateWithData(angular.copy(e.data)):e.api.updateWithData(e.data),(a.title||e._config.extended)&&c("title"),(a.subtitle||e._config.extended)&&c("subtitle"),(a.caption||e._config.extended)&&c("caption"),(a.styles||e._config.extended)&&r(),nv.addGraph(function(){return e.chart?(e.chart.resizeHandler&&e.chart.resizeHandler.clear(),e.chart.resizeHandler=nv.utils.windowResize(function(){e.chart&&e.chart.update&&e.chart.update()}),void 0!==a.chart.zoom&&["scatterChart","lineChart","candlestickBarChart","cumulativeLineChart","historicalBarChart","ohlcBarChart","stackedAreaChart"].indexOf(a.chart.type)>-1&&t.zoom(e,a),e.chart):void 0},a.chart.callback))},updateWithData:function(t){if(t){d3.select(a[0]).select("svg").remove();var n,i;e.svg=d3.select(a[0]).append("svg"),(n=e.options.chart.height)&&(isNaN(+n)||(n+="px"),e.svg.attr("height",n).style({height:n})),(i=e.options.chart.width)?(isNaN(+i)||(i+="px"),e.svg.attr("width",i).style({width:i})):e.svg.attr("width","100%").style({width:"100%"}),e.svg.datum(t).call(e.chart)}},clearElement:function(){if(a.find(".title").remove(),a.find(".subtitle").remove(),a.find(".caption").remove(),a.empty(),e.chart&&e.chart.tooltip&&e.chart.tooltip.id&&d3.select("#"+e.chart.tooltip.id()).remove(),nv.graphs&&e.chart)for(var t=nv.graphs.length-1;t>=0;t--)nv.graphs[t]&&nv.graphs[t].id===e.chart.id&&nv.graphs.splice(t,1);nv.tooltip&&nv.tooltip.cleanup&&nv.tooltip.cleanup(),e.chart&&e.chart.resizeHandler&&e.chart.resizeHandler.clear(),e.chart=null},getScope:function(){return e},getElement:function(){return a}},e._config.deepWatchOptions&&e.$watch("options",t.debounce(function(t){e._config.disabled||e.api.refresh()},e._config.debounce,e._config.debounceImmediate),!0),e._config.deepWatchData&&(1===e._config.deepWatchDataDepth?e.$watchCollection("data",l):e.$watch("data",l,2===e._config.deepWatchDataDepth)),e.$watch("config",function(t,a){t!==a&&(e._config=angular.extend(h,t),e.api.refresh())},!0),e._config.deepWatchOptions||e._config.deepWatchData||e.api.refresh(),angular.forEach(e.events,function(t,a){e.$on(a,function(a,n){return t(a,e,n)})}),a.on("$destroy",function(){e.api.clearElement()}),e.$watch("isReady",function(t){t&&e.onReady&&"function"==typeof e.onReady()&&e.onReady()(e,a)})}}}]).factory("nvd3Utils",function(){return{debounce:function(t,e,a){var n;return function(){var i=this,o=arguments,c=function(){n=null,a||t.apply(i,o)},r=a&&!n;clearTimeout(n),n=setTimeout(c,e),r&&t.apply(i,o)}},deepExtend:function(t){var e=this;return angular.forEach(arguments,function(a){a!==t&&angular.forEach(a,function(a,n){t[n]&&t[n].constructor&&t[n].constructor===Object?e.deepExtend(t[n],a):t[n]=a})}),t},zoom:function(t,e){var a=e.chart.zoom,n="undefined"==typeof a.enabled||null===a.enabled?!0:a.enabled;if(n){var i,o,c,r,s,d=t.chart.xAxis.scale(),l=t.chart.yAxis.scale(),h=t.chart.xDomain||d.domain,u=t.chart.yDomain||l.domain,p=d.domain().slice(),f=l.domain().slice(),g=a.scale||1,v=a.translate||[0,0],m=a.scaleExtent||[1,10],x=a.useFixedDomain||!1,y=a.useNiceScale||!1,b=a.horizontalOff||!1,_=a.verticalOff||!1,C=a.unzoomEventType||"dblclick.zoom";y&&(d.nice(),l.nice()),i=function(t,e){return t[0]=Math.min(Math.max(t[0],e[0]),e[1]-e[1]/m[1]),t[1]=Math.max(e[0]+e[1]/m[1],Math.min(t[1],e[1])),t},c=function(){if(void 0!==a.zoomed){var e=a.zoomed(d.domain(),l.domain());b||h([e.x1,e.x2]),_||u([e.y1,e.y2])}else b||h(x?i(d.domain(),p):d.domain()),_||u(x?i(l.domain(),f):l.domain());t.chart.update()},r=function(){if(void 0!==a.unzoomed){var e=a.unzoomed(d.domain(),l.domain());b||h([e.x1,e.x2]),_||u([e.y1,e.y2])}else b||h(p),_||u(f);o.scale(g).translate(v),t.chart.update()},s=function(){void 0!==a.zoomend&&a.zoomend()},o=d3.behavior.zoom().x(d).y(l).scaleExtent(m).on("zoom",c).on("zoomend",s),t.svg.call(o),o.scale(g).translate(v).event(t.svg),"none"!==C&&t.svg.on(C,r)}}}})}();